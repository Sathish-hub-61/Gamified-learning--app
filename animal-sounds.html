<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Animal Sounds - PlayLearn</title>

    <link rel="stylesheet" href="css/global.css">

    <style>
        body {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            min-height: 100vh;
            padding: var(--spacing-md);
        }

        .game-container {
            max-width: 700px;
            margin: 0 auto;
        }

        .header {
            background: var(--white);
            border-radius: var(--radius-xl);
            padding: var(--spacing-xl);
            margin-bottom: var(--spacing-lg);
            text-align: center;
            box-shadow: var(--shadow-lg);
        }

        .score {
            font-size: var(--font-size-2xl);
            font-weight: 700;
            color: var(--secondary-gold);
        }

        .question-card {
            background: var(--white);
            border-radius: var(--radius-xl);
            padding: var(--spacing-2xl);
            margin-bottom: var(--spacing-lg);
            box-shadow: var(--shadow-lg);
            text-align: center;
        }

        .question {
            font-size: var(--font-size-2xl);
            color: var(--neutral-dark);
            margin-bottom: var(--spacing-xl);
        }

        .animal-display {
            font-size: 10rem;
            margin: var(--spacing-xl) 0;
            animation: bounce 2s ease-in-out infinite;
        }

        .sound-btn {
            font-size: var(--font-size-2xl);
            padding: var(--spacing-xl) var(--spacing-2xl);
            margin-bottom: var(--spacing-xl);
            width: 100%;
        }

        .options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--spacing-lg);
        }

        .option-btn {
            font-size: var(--font-size-xl);
            padding: var(--spacing-xl);
            border-radius: var(--radius-lg);
            border: 3px solid transparent;
            transition: all var(--transition-base);
        }

        .option-btn:hover {
            transform: scale(1.1);
            border-color: var(--primary-purple);
        }

        .option-btn.correct {
            background: var(--success);
            color: var(--white);
            animation: correctPulse 0.5s ease;
        }

        .option-btn.wrong {
            background: var(--error);
            color: var(--white);
            animation: shake 0.5s ease;
        }

        @keyframes correctPulse {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.15);
            }
        }

        @keyframes shake {

            0%,
            100% {
                transform: translateX(0);
            }

            25% {
                transform: translateX(-10px);
            }

            75% {
                transform: translateX(10px);
            }
        }

        .feedback {
            margin-top: var(--spacing-lg);
            padding: var(--spacing-lg);
            border-radius: var(--radius-md);
            font-size: var(--font-size-xl);
            font-weight: 600;
            display: none;
        }

        .feedback.show {
            display: block;
        }

        .back-button {
            position: fixed;
            top: 20px;
            left: 20px;
            background: white;
            border: none;
            border-radius: 12px;
            padding: 12px 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            transition: all 0.3s;
            z-index: 1000;
            font-size: 16px;
            font-weight: 700;
            color: #333;
        }

        .back-button:hover {
            transform: translateY(-2px);
            background: #FF69B4;
            color: white;
        }

        .parents-button {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border: none;
            border-radius: 12px;
            padding: 12px 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            transition: all 0.3s;
            z-index: 1000;
            font-size: 16px;
            font-weight: 700;
            color: #9370DB;
            text-decoration: none;
        }

        .parents-button:hover {
            transform: translateY(-2px);
            background: #9370DB;
            color: white;
        }
    </style>
</head>

<body>
    <button class="back-button" onclick="window.location.href='game-hub-3-5.html'">
        ‚Üê Back
    </button>
    <a href="parent-dashboard-3-5.html" class="parents-button">
        üë®‚Äçüë©‚Äçüëß Parents
    </a>
    <div class="game-container">
        <div class="header">
            <h1 style="color: var(--secondary-coral); margin: 0 0 var(--spacing-sm) 0;">üê∂ Animal Sounds!</h1>
            <div class="score">‚≠ê Score: <span id="score">0</span></div>
        </div>

        <div class="question-card">
            <p class="question">What sound does this animal make?</p>

            <div class="animal-display" id="animal-display">üê∂</div>

            <button class="btn btn-primary sound-btn" onclick="playSound()">
                üîä Hear the Sound!
            </button>

            <div class="options" id="options"></div>

            <div class="feedback" id="feedback"></div>
        </div>

    </div>

    <script src="js/audio-manager.js"></script>
    <script>
        const audioManager = new AudioManager();
        const GAME_ID = 'animal-sounds';
        let score = 0;
        let currentQuestion = 0;
        let shuffledAnimals = [];
        let totalAttempts = 0;
        let correctCount = 0;

        const allAnimals = [
            { emoji: 'üê∂', sound: 'Woof Woof!', file: 'Dog.aac', options: ['Woof Woof!', 'Meow!', 'Moo!', 'Quack!'] },
            { emoji: 'üê±', sound: 'Meow!', file: 'Cat.aac', options: ['Woof Woof!', 'Meow!', 'Moo!', 'Oink!'] },
            { emoji: 'üêÆ', sound: 'Moo!', file: 'Cow.aac', options: ['Baa!', 'Meow!', 'Moo!', 'Quack!'] },
            { emoji: 'üê∑', sound: 'Oink!', file: 'Pig.aac', options: ['Woof Woof!', 'Neigh!', 'Moo!', 'Oink!'] },
            { emoji: 'üê¥', sound: 'Neigh!', file: 'Horse.aac', options: ['Neigh!', 'Meow!', 'Moo!', 'Quack!'] },
            { emoji: 'ü¶Ü', sound: 'Quack!', file: 'Duck.mpeg', options: ['Woof Woof!', 'Meow!', 'Quack!', 'Oink!'] },
            { emoji: 'üêë', sound: 'Baa!', file: 'Sheep.aac', options: ['Baa!', 'Meow!', 'Moo!', 'Quack!'] },
            { emoji: 'üêî', sound: 'Cluck Cluck!', file: 'Hen.aac', options: ['Woof Woof!', 'Cluck Cluck!', 'Moo!', 'Quack!'] },
            { emoji: 'üê∏', sound: 'Ribbit!', file: 'Frog.mpeg', options: ['Ribbit!', 'Meow!', 'Moo!', 'Quack!'] },
            { emoji: 'ü¶Å', sound: 'Roar!', file: 'Lion.aac', options: ['Woof Woof!', 'Roar!', 'Moo!', 'Quack!'] },
            { emoji: 'üêò', sound: 'Trumpet!', file: 'Elephant.mpeg', options: ['Trumpet!', 'Meow!', 'Moo!', 'Quack!'] },
            { emoji: 'ü¶â', sound: 'Hoot Hoot!', file: 'Owl.mpeg', options: ['Woof Woof!', 'Hoot Hoot!', 'Moo!', 'Quack!'] }
        ];

        // Shuffle function
        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        // Initialize game with shuffled animals
        function initGame() {
            shuffledAnimals = shuffleArray(allAnimals);
            currentQuestion = 0;
            score = 0;
            document.getElementById('score').textContent = score;
            loadQuestion();
        }

        function loadQuestion() {
            const animal = shuffledAnimals[currentQuestion];
            document.getElementById('animal-display').textContent = animal.emoji;
            document.getElementById('feedback').classList.remove('show');

            const optionsContainer = document.getElementById('options');
            optionsContainer.innerHTML = '';

            animal.options.forEach(option => {
                const btn = document.createElement('button');
                btn.className = 'btn btn-success option-btn';
                btn.textContent = option;
                btn.onclick = () => checkAnswer(option);
                optionsContainer.appendChild(btn);
            });
        }

        function playSound() {
            const animal = shuffledAnimals[currentQuestion];
            if (animal.file && !audioManager.isMuted) {
                const audioPath = `assets/audio/Animal Sounds/${animal.file}`;
                const audioInstance = new Audio(audioPath);
                audioInstance.play().catch(e => console.error("Error playing animal sound:", e));
            }
            audioManager.playSound('click');
        }

        function checkAnswer(selected) {
            const animal = shuffledAnimals[currentQuestion];
            const buttons = document.querySelectorAll('.option-btn');
            const feedback = document.getElementById('feedback');
            totalAttempts++;

            buttons.forEach(btn => {
                btn.disabled = true;
                if (btn.textContent === animal.sound) {
                    btn.classList.add('correct');
                } else if (btn.textContent === selected && selected !== animal.sound) {
                    btn.classList.add('wrong');
                }
            });

            if (selected === animal.sound) {
                correctCount++;
                score += 10;
                document.getElementById('score').textContent = score;
                feedback.textContent = `üéâ Yes! The animal says ${animal.sound}`;
                feedback.style.background = 'var(--success)';
                feedback.style.color = 'var(--white)';
                feedback.classList.add('show');
                audioManager.playSound('correct');

                setTimeout(() => {
                    const wasLastQuestion = currentQuestion === shuffledAnimals.length - 1;
                    currentQuestion = (currentQuestion + 1) % shuffledAnimals.length;

                    if (window.saveGameProgress) {
                        window.saveGameProgress(GAME_ID, {
                            score: score,
                            completed: wasLastQuestion,
                            attempts: totalAttempts,
                            correctAnswers: correctCount
                        });
                    }

                    loadQuestion();
                }, 2500);
            } else {
                feedback.textContent = `Try again! The animal says ${animal.sound}`;
                feedback.style.background = 'var(--warning)';
                feedback.style.color = 'var(--white)';
                feedback.classList.add('show');
                audioManager.playSound('wrong');

                setTimeout(() => {
                    loadQuestion();
                }, 2500);
            }
        }

        // Initialize game on page load
        initGame();
    </script>
    <script type="module" src="js/progress-service.js"></script>
</body>

</html>