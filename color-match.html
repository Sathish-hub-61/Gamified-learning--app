<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Color Match - PlayLearn</title>

    <link rel="stylesheet" href="css/global.css">

    <style>
        body {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            min-height: 100vh;
            padding: var(--spacing-md);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .game-container {
            background: var(--white);
            border-radius: var(--radius-xl);
            padding: var(--spacing-2xl);
            max-width: 600px;
            width: 100%;
            text-align: center;
            box-shadow: var(--shadow-lg);
        }

        .game-title {
            font-size: var(--font-size-3xl);
            color: var(--secondary-coral);
            margin-bottom: var(--spacing-xl);
        }

        .question {
            font-size: var(--font-size-2xl);
            margin-bottom: var(--spacing-xl);
            color: var(--neutral-dark);
        }

        .options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: var(--spacing-lg);
            margin-bottom: var(--spacing-xl);
        }

        .option {
            padding: var(--spacing-2xl);
            border-radius: var(--radius-lg);
            cursor: pointer;
            transition: all var(--transition-base);
            border: 4px solid transparent;
            font-size: var(--font-size-3xl);
        }

        .option:hover {
            transform: scale(1.1);
            border-color: var(--primary-purple);
        }

        .option.correct {
            animation: correctPulse 0.5s ease;
            border-color: var(--success);
        }

        @keyframes correctPulse {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.2);
            }
        }

        .feedback {
            font-size: var(--font-size-xl);
            padding: var(--spacing-lg);
            border-radius: var(--radius-md);
            margin-top: var(--spacing-lg);
            display: none;
        }

        .feedback.show {
            display: block;
        }

        .feedback.success {
            background: var(--success);
            color: var(--white);
        }

        .back-button {
            position: fixed;
            top: 20px;
            left: 20px;
            background: white;
            border: none;
            border-radius: 12px;
            padding: 12px 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            transition: all 0.3s;
            z-index: 1000;
            font-size: 16px;
            font-weight: 700;
            color: #333;
        }

        .back-button:hover {
            transform: translateY(-2px);
            background: #FF69B4;
            color: white;
        }

        .parents-button {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border: none;
            border-radius: 12px;
            padding: 12px 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            transition: all 0.3s;
            z-index: 1000;
            font-size: 16px;
            font-weight: 700;
            color: #9370DB;
            text-decoration: none;
        }

        .parents-button:hover {
            transform: translateY(-2px);
            background: #9370DB;
            color: white;
        }
    </style>
</head>

<body>
    <button class="back-button" onclick="window.location.href='game-hub-3-5.html'">
        ‚Üê Back
    </button>
    <a href="parent-dashboard-3-5.html" class="parents-button">
        üë®‚Äçüë©‚Äçüëß Parents
    </a>
    <button id="mute-toggle" class="btn-mute"
        style="position: fixed; bottom: 20px; right: 20px; font-size: 20px; background: white; border: none; border-radius: 50%; width: 40px; height: 40px; cursor: pointer; box-shadow: var(--shadow-md); z-index: 1000;">üîä</button>
    <div class="game-container">
        <h1 class="game-title">üé® Color Match!</h1>
        <p class="question" id="question">What color is this fruit?</p>

        <div style="font-size: 8rem; margin: var(--spacing-xl) 0;" id="fruit-display">üçé</div>

        <div class="options" id="options">
            <div class="option" style="background: #FF0000;" onclick="checkAnswer('red')"></div>
            <div class="option" style="background: #FFFF00;" onclick="checkAnswer('yellow')"></div>
            <div class="option" style="background: #00FF00;" onclick="checkAnswer('green')"></div>
            <div class="option" style="background: #FFA500;" onclick="checkAnswer('orange')"></div>
            <div class="option" style="background: #800080;" onclick="checkAnswer('purple')"></div>
        </div>

        <div class="feedback" id="feedback"></div>

    </div>

    <script src="js/audio-manager.js"></script>
    <script>
        const audioManager = new AudioManager();
        audioManager.initBackgroundMusic();

        document.getElementById('mute-toggle').addEventListener('click', () => {
            audioManager.toggleMute();
            audioManager.playSound('click');
        });

        const GAME_ID = 'color-match';

        const allQuestions = [
            { fruit: 'üçé', color: 'red', name: 'Apple' },
            { fruit: 'üçå', color: 'yellow', name: 'Banana' },
            { fruit: 'üçá', color: 'purple', name: 'Grapes' },
            { fruit: 'üçè', color: 'green', name: 'Green Apple' },
            { fruit: 'üçä', color: 'orange', name: 'Orange' },
            { fruit: 'üçì', color: 'red', name: 'Strawberry' },
            { fruit: 'üçã', color: 'yellow', name: 'Lemon' },
            { fruit: 'ü•ï', color: 'orange', name: 'Carrot' },
            { fruit: 'üçâ', color: 'green', name: 'Watermelon' },
            { fruit: 'üçÜ', color: 'purple', name: 'Eggplant' }
        ];

        let questions = [];
        let currentQuestion = 0;
        let score = 0;
        let totalAttempts = 0;
        let correctCount = 0;

        // Shuffle function
        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        // Initialize game with shuffled questions
        function initGame() {
            questions = shuffleArray(allQuestions);
            currentQuestion = 0;
            loadQuestion();
        }

        function loadQuestion() {
            const q = questions[currentQuestion];
            document.getElementById('fruit-display').textContent = q.fruit;
            document.getElementById('feedback').classList.remove('show');
        }

        function checkAnswer(color) {
            const q = questions[currentQuestion];
            const feedback = document.getElementById('feedback');
            totalAttempts++;

            if (color === q.color) {
                correctCount++;
                score += 10;
                feedback.textContent = `üéâ Yes! ${q.name} is ${color}!`;
                feedback.className = 'feedback success show';
                audioManager.playSound('correct');

                setTimeout(() => {
                    const wasLastQuestion = currentQuestion === questions.length - 1;
                    currentQuestion = (currentQuestion + 1) % questions.length;

                    // Track progress
                    if (window.saveGameProgress) {
                        window.saveGameProgress(GAME_ID, {
                            score: score,
                            completed: wasLastQuestion,
                            attempts: totalAttempts,
                            correctAnswers: correctCount
                        });
                    }

                    loadQuestion();
                }, 2000);
            } else {
                feedback.textContent = `Try again! üí™`;
                feedback.className = 'feedback show';
                feedback.style.background = 'var(--warning)';
                feedback.style.color = 'var(--white)';
                audioManager.playSound('wrong');
            }
        }

        // Initialize game on page load
        initGame();
    </script>
    <script type="module" src="js/progress-service.js"></script>
</body>

</html>